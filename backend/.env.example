# ============================================
# AURA PRESENCE - Backend Environment Variables
# ============================================
# Kopiere diese Datei nach .env und fülle die Werte aus:
# cp .env.example .env

# ============================================
# REQUIRED (Server startet nicht ohne diese)
# ============================================

# Node-Umgebung: development | production | test
NODE_ENV=development

# Server-Port (Standard: 3000)
PORT=3000

# JWT Secret für Token-Signierung (MUSS mindestens 32 Zeichen haben!)
# Generiere mit: openssl rand -base64 48
# WICHTIG: In Production NIEMALS den Default-Wert verwenden!
JWT_SECRET=your-super-secret-jwt-key-min-32-chars

# JWT Refresh Secret (separater Key für Refresh Tokens)
JWT_REFRESH_SECRET=your-super-secret-refresh-key-min-32-chars

# Datenbank-URL (PostgreSQL/Supabase)
# Format: postgresql://user:password@host:port/database
# Supabase: Get from Project Settings > Database > Connection String (Connection Pooler)
DATABASE_URL=postgresql://postgres:password@localhost:5432/aura_presence

# ============================================
# SENTRY ERROR TRACKING (Optional, aber empfohlen für Production)
# ============================================

# Sentry Backend DSN
# CRITICAL: Ohne diese Variable wird Sentry NICHT initialisiert
# Erhalten unter: https://sentry.io/settings/[org]/projects/[project]/keys/
SENTRY_DSN_BACKEND=

# Sentry aktivieren/deaktivieren (default: true wenn DSN gesetzt)
# Setze auf 'false' um Sentry komplett zu deaktivieren
SENTRY_ENABLED=true

# Sentry Environment (development | staging | production)
# Wird automatisch aus NODE_ENV übernommen wenn nicht gesetzt
SENTRY_ENVIRONMENT=development

# Sentry Release Version (wird in CI automatisch gesetzt)
# Format: Commit SHA oder Semantic Version (z.B. 1.2.3)
# Wird für Source Map Upload und Release Tracking verwendet
SENTRY_RELEASE=

# Sentry Traces Sample Rate (0.0 - 1.0)
# 0.05 = 5% der Requests werden getrackt (empfohlen für Production)
# 1.0 = 100% für Development/Testing
SENTRY_TRACES_SAMPLE_RATE=0.05

# Sentry Auth Token für CI/CD Release Upload (NUR für CI!)
# CRITICAL: NIEMALS in Git committen! Nur als GitHub Secret setzen!
# Erhalten unter: https://sentry.io/settings/account/api/auth-tokens/
SENTRY_AUTH_TOKEN=

# Sentry Organization Slug (für CI Release Upload)
SENTRY_ORG=

# Sentry Project Slug Backend (für CI Release Upload)
SENTRY_PROJECT_BACKEND=

# ============================================
# OPTIONAL (mit funktionierenden Defaults)
# ============================================

# JWT Token-Lebensdauer (Standard: 7d = 7 Tage)
JWT_EXPIRES_IN=7d

# Frontend-URL für CORS
FRONTEND_URL=http://localhost:5173
CORS_ORIGINS=http://localhost:5173

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Logging-Level: error | warn | info | debug
LOG_LEVEL=info

# ============================================
# DRITTANBIETER-APIs (Optional)
# ============================================

# OpenAI API Key für KI-Interpretationen
OPENAI_API_KEY=

# Stripe (Subscription-System)
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRICE_ID=

# Supabase (Storage, Realtime)
SUPABASE_URL=
SUPABASE_ANON_KEY=
SUPABASE_SERVICE_KEY=

# ============================================
# DATABASE CONNECTION POOL
# ============================================

DB_POOL_MIN=2
DB_POOL_MAX=10

# ============================================
# HINWEISE: SENTRY INTEGRATION
# ============================================
#
# WICHTIG - DATENSCHUTZ:
# Sentry-Integration enthält automatisches PII-Scrubbing für:
# - Video-Frames (videoFrame, frameData, payload.frames)
# - Audio-Daten (rawAudio, audioBuffer)
# - Base64-Strings (über 100 Zeichen)
# - Große Binärdaten (über 1MB)
#
# NIEMALS in Sentry sichtbar:
# - Rohe Video/Audio-Streams
# - MediaPipe Frame-Daten
# - User-Uploads (Bilder, Videos)
#
# SENTRY DEAKTIVIEREN:
# 1. Setze SENTRY_ENABLED=false
# 2. Oder entferne SENTRY_DSN_BACKEND komplett
# 3. Server-Neustart erforderlich
#
# TESTING SENTRY:
# curl -X GET http://localhost:3000/test/sentry
# Erwarte: HTTP 500 + Event ID in Sentry UI
#
# CI/CD SETUP:
# - Setze SENTRY_AUTH_TOKEN als GitHub Secret
# - SENTRY_ORG und SENTRY_PROJECT_BACKEND auch als Secrets
# - Release wird automatisch bei Deploy erstellt
#
# MEHR INFOS:
# - Dokumentation/SENTRY_INTEGRATION.md
